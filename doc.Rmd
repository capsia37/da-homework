---
title: "Homework DA"
output: html_document
date: "`r Sys.Date()`"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Compito di Data Analytics

Gruppo C: ZANNI, JIMÉNEZ LIRIANO, RICCIO, SMOKOVIĆ

## Importazione dei dati

```{r}
BankChurners = read.csv("credit-card-customers/BankChurners.csv", stringsAsFactors = T)
HousePrices = read.csv("house-prices/train.csv", stringsAsFactors = T)
```

## ANALISI DEL DATASET "BankChurners"

```{r}
str(BankChurners)
head(BankChurners)
summary(BankChurners)
sum(is.na(BankChurners))
```

### PER LE VARIABILI DI TIPO QUANTITATIVE(integer/numeric)

```{r}
# Customer_age
eta_media <- mean(BankChurners$Customer_Age) # eta media dei clienti
round(eta_media, digits = 1) # arrotondando a una cifra decimale

sd(BankChurners$Customer_Age) # deviazione standard
quantile(BankChurners$Customer_Age) # quantili
# notiamo che l'eta dei clienti sta nell'intervallo dai 26 ai 73 anni
# con 26 anni il cliente piu giovane e 73 il piu anziano
summary(BankChurners$Customer_Age) # e lo possiamo notare anche in questo modo

# visualizzazione grafica
hist(BankChurners$Customer_Age, main = "Istogramma delle eta", xlab = "Eta", ylab = "Frequenza")

boxplot(BankChurners$Customer_Age, main = "Boxplot delle eta", ylab = "Frequenza")


# Dependent_count
summary(BankChurners$Dependent_count) #abbiamo da 0 a 5 dipendenti assegnati
round(mean(BankChurners$Dependent_count), digits = 1) #media
median(BankChurners$Dependent_count) #mediana
sd(BankChurners$Dependent_count) #deviazione standard

#visualizzazione grafica
hist(BankChurners$Dependent_count, main="Istogramma di Dependent Count", xlab="Numero di Dipendenti", 
ylab="Frequenza", breaks=8, col="lightblue")

# notiamo che la maggioranza dei clienti possiede dai 2 ai 3 dipendenti associati

# controllando i numeri:
table(BankChurners$Dependent_count)

# aggiungendo la retta della media delle frequenze:
media_dip <- mean(table(BankChurners$Dependent_count))
abline(h = media_dip, col = "red", lwd = 2)
legend("topright", legend = paste("Media =", round(media_dip, 2)), 
       col = "red", lwd = 2, bty = "n")


# Credit_Limit
summary(BankChurners$Credit_Limit) # limite del credito che va da 1.4k a 34k
media_credito <- round(mean(BankChurners$Credit_Limit), digits = 0) # credito limite medio

# visualizzazione grafica:
hist(BankChurners$Credit_Limit)
abline(v= media_credito, col = "red", lwd = 2)
legend("topright", legend = paste("Media =", media_credito), 
       col = "red", lwd = 2, bty = "n")

# notiamo che il grafico e' piu' popolato ovvero ci sono piu' clienti al di sotto della media
# sono piu' numerosi i clienti con credito limite massimo (34k) che i clienti nei vari intervalli tra 10k e 33k

# Avg_Open_To_Buy
summary(BankChurners$Avg_Open_To_Buy)
hist(BankChurners$Avg_Open_To_Buy, main = "Istogramma", xlab = "Media Compera", ylab = "Frequenza")

# notiamo che i valori massimi sono esattamente il credito limite dei clienti
# il grafico segue un andamento esponenziale verso il basso
# e' molto simile al grafico visto in precedenza riguardante il credito limite
# quindi da questi grafici si nota come praticamenti tutti i clienti raggiungano o quasi il credito limite

#Month_On_Book
summary(BankChurners$Months_on_book) #il tempo minimo trascorso con la banca e' di 13 mesi invece il
# maggior tempo trascorso e' di 56 mesi
# vedendolo graficamente:
hist(BankChurners$Months_on_book, main = "Istogramma mesi trascorsi", xlab = "Mesi", ylab = "Frequenza")
media_mesi <- mean(BankChurners$Months_on_book)
abline(v= media_mesi, col = "blue", lwd = 3)
legend("topright", legend = paste("Media =", round(media_mesi, digits = 0)), 
       col = "blue", lwd = 2, bty = "n")

# osserviamo che poche persone restano poco o tanto 
# la maggior parte dei clienti resta con la banca tra i 35 e i 40 mesi

#Total_Trans_Amt
summary(BankChurners$Total_Trans_Amt) # transazioni minime e massime negli ultimi 12 mesi
# minima di 510 dollari
# la massima e' di 18k dollari

# grafico:
hist(BankChurners$Total_Trans_Amt, main = "Istogramma delle transazioni per 12 mesi", xlab = "Mesi",
     ylab = "Frequenza")

# si nota che la maggioranza si tiene sotto i 5k dollari di spesa
# aggiungendo la media:
media_transazioni <- mean(BankChurners$Total_Trans_Amt)
abline(v= media_transazioni, col = "orange", lwd = 3)
legend("topright", legend = paste("Media =", round(media_transazioni, digits = 0)), 
       col = "orange", lwd = 2, bty = "n")

# come detto poco fa una volta superata la media delle transazioni la frequenza delle persone si abbassa
```

### PER LE VARIABILI DI TIPO CATEGORIALE(factor)

```{r}
# sesso
BankChurners$Gender <- factor(BankChurners$Gender) # converto in un fattore per fare l'analisi
levels(BankChurners$Gender)
str(BankChurners$Gender)

# per calcolare la frequenza assoluta
table(BankChurners$Gender)
# marginale
prop.table(table(BankChurners$Gender))

# Grafico a barre
barplot(table(BankChurners$Gender), main="Grafico a barre variabile sesso", xlab="Categoria", ylab="Frequenza")


# Education_Level
BankChurners$Education_Level <- factor(BankChurners$Education_Level) # conversione in fattore
summary(BankChurners$Education_Level)
str(BankChurners$Education_Level)
barplot(table(BankChurners$Education_Level), main = "Grafico a barre livello educazione", xlab = "Educazione",
        ylab = "Frequenza")


#Marital_Status
BankChurners$Marital_Status <- factor(BankChurners$Marital_Status)
str(BankChurners$Marital_Status) # ho 4 livelli(divorziato, sposato, single e stato sconosciuto)
summary(BankChurners$Marital_Status)

barplot(table(BankChurners$Marital_Status), main= "Grafico a barre", xlab="Categoria", ylab="Frequenza")
# la maggioranza delle persone e' sposata oppure single
# distribuendo gli stati sconosciuti il risultato sarebbe sempre lo stesso

round(prop.table(table(BankChurners$Marital_Status)), digits = 3)
# il 46% delle persone e' sposato
# il 38% e' single
# il 16% altro

# Income_Category
BankChurners$Income_Category <- factor(BankChurners$Income_Category)
summary(BankChurners$Income_Category)
str(BankChurners$Income_Category)

# frequenze:
table(BankChurners$Income_Category) # stesso output di summary
prop.table(table(BankChurners$Income_Category))

# Card_Category
BankChurners$Card_Category <- factor(BankChurners$Card_Category)
str(BankChurners$Card_Category)
summary(BankChurners$Card_Category)

barplot(table(BankChurners$Card_Category), main = "Grafico per la categoria delle carte", xlab = "Tipo di carta", 
     ylab = "Frequenza")
# notiamo che la carta di credito di tipo Blue e' nettamente la piu' presente
```

## ANALISI DEL DATASET "HousePrices"

```{r}
HousePrices$MSSubClass <- factor(HousePrices$MSSubClass)
HousePrices$BsmtFullBath <- factor(HousePrices$BsmtFullBath)
HousePrices$BsmtHalfBath <- factor(HousePrices$BsmtHalfBath)
HousePrices$FullBath <- factor(HousePrices$FullBath)
HousePrices$HalfBath <- factor(HousePrices$HalfBath)
HousePrices$BedroomAbvGr <- factor(HousePrices$BedroomAbvGr)
HousePrices$KitchenAbvGr <- factor(HousePrices$KitchenAbvGr)
HousePrices$Fireplaces <- factor(HousePrices$Fireplaces)
HousePrices$GarageCars <- factor(HousePrices$GarageCars)
```

```{r}
univarQual <- function(dfcol) {
  barplot(table(HousePrices[, dfcol[1]]), main=dfcol[1])
  print(table(HousePrices[, dfcol[1]]))
  cat("\n", dfcol[2], "\n")
}
```

```{r, include=FALSE}
qualVarDesc <- cbind.data.frame(colnames(Filter(is.factor,HousePrices)), c(
  "Le case più frequenti sono a 1 o 2 piani successive al 1946",
  "Le case nel dataset sono prevalentemente in zone residenziali a bassa e media densità",
  "Solo 6 delle case hanno un accesso non asfaltato sulla strada",
  "Le case generalmente non hanno un vialetto, tra quelle in cui c'è per metà sono asfaltati",
  "La maggior parte delle proprietà nel dataset sono regolari o presentano lievi irregolarità nella forma",
  "Prevalgono le case costruite in piano",
  "Hanno tutte i servizi essenziali, tranne una",
  "I terreni interni e in angolo sono più frequenti",
  "La pendenza del suolo nelle proprietà è lieve nella maggior parte dei casi",
  "I quartieri più scelti sono North Ames, College Creek e Old Town",
  "La maggior parte delle case non ha stazioni, arterie o strade di collegamento adiacenti",
  "Molto simile al grafico precedente",
  "Sono quasi tutte unifamiliari, seguono le villette a schiera",
  "Le case sono prevalentemente a un piano o a due piani",
  "I tetti sono a capanna o a falde",
  "Le coperture sono in tegole standard",
  "",
  "",
  "I rivestimenti spesso non sono presenti, qualora fossero presenti sono spesso in mattone e più raramente in pietra",
  "La qualità dei materiali esterni viene generalmente considerata nella media o buona",
  "Le condizioni dei materiali esterni sono nella media o buone, ma raramente anche decenti",
  "Le fondamenta sono in calcestruzzo o cemento",
  "Qualità del seminterrato buona o nella media",
  "Condizioni del seminterrato nella media",
  "Il seminterrato raramente può essere esposto ma generalmente non lo è",
  "I rating del seminterrato sono disomogenei",
  "Il secondo seminterrato non è completato",
  "Riscaldamento con gas ad aria calda",
  "Qualità riscaldamento eccellente, seguita da nella media e da buona",
  "Riscaldamento centralizzato presente",
  "Interruttori elettrici standard",
  "Le case non hanno bagni completi nel seminterrato o ne hanno uno solo",
  "Non hanno mezzi bagni nel seminterrato",
  "Hanno uno o due bagni completi in casa",
  "Hanno uno o nessun mezzo bagno in casa",
  "Hanno generalmente tra 2 e 4 stanze da letto",
  "Le case hanno solitamente una sola cucina",
  "Qualità della cucina nella media o buona",
  "La casa è funzionale non danneggiata",
  "Raramente c'è più di un camino in casa",
  "Qualità dei camini, buona o nella media",
  "Garage annessi o indipendenti",
  "Molti dei garage non sono finiti, altri sono finiti in uno stato grezzo, altri ancora sono finiti",
  "La capienza dei garage contiene 2 auto o meno frequentemente 1 sola",
  "Qualità del garage nella media",
  "Condizioni del garage nella media",
  "Strada del garage asfaltata",
  "Qualità piscina equamente distribuita tra eccellente, buona e decente",
  "Il confine offre un minimo di privacy",
  "Generalmente non sono presenti altre strutture, avvolte sono presenti capannoni",
  "Vendita con atto di garanzia convenzionale",
  "Condizioni di vendita generalmente normali"
))

names(qualVarDesc) <- c("var", "desc")
```

```{r}
apply(qualVarDesc, 1, univarQual)
```

```{r}
summary(HousePrices$LotFrontage)
boxplot(HousePrices$LotFrontage)
hist(HousePrices$LotFrontage, freq = F)
plot(density(HousePrices$LotFrontage, na.rm = T))
qqnorm(HousePrices$LotFrontage)
qqline(HousePrices$LotFrontage)
```

La distribuzione non è normale nelle code. Il boxplot evidenzia che i valori sono solitamente nell'intervallo tra 50 e 100 piedi lineari, spesso possono raggiungere fino ai 200 piedi lineari. Inoltre è presente un outlier superiore a 300 piedi lineari. Confrontando il primo e il terzo quartile si nota che la distribuzione è solo lievemente asimmetrica.

```{r}
summary(HousePrices$LotArea)
boxplot(log(HousePrices$LotArea))
hist(log(HousePrices$LotArea), freq=F)
plot(density(log(HousePrices$LotArea), na.rm = T))
qqnorm(HousePrices$LotArea)
qqline(HousePrices$LotArea)
qqnorm(log(HousePrices$LotArea))
qqline(log(HousePrices$LotArea))
```

La distribuzione non è normale nelle code, non lo è neanche il suo logaritmo. La media si attesta intorno ai 10500 piedi quadrati e dai quartili si nota che è asimmetrica.

```{r}
summary(HousePrices$OverallQual)
table(HousePrices$OverallQual)
boxplot(HousePrices$OverallQual)
hist(HousePrices$OverallQual)
```

La maggior parte delle case è valutata con una qualità tra 5 e 7 decimi

```{r}
summary(HousePrices$OverallCond)
table(HousePrices$OverallCond)
boxplot(HousePrices$OverallCond)
hist(HousePrices$OverallCond)
```

La valutazione delle condizioni solitamente è 5/10 e varia generalmente tra 4 e 7 decimi con alcuni outlier

```{r}
summary(HousePrices$YearBuilt)
boxplot(HousePrices$YearBuilt)
hist(HousePrices$YearBuilt, freq = F)
plot(density(HousePrices$YearBuilt, na.rm = T))
```

Dal grafico della densità si nota che la distribuzione dei dati ha 3 mode, quindi si evidenziano periodi in cui venivano costruite molte case seguiti da periodi in cui la costruzione di case diminuisce significativamente. Dal boxplot notiamo che la maggior parte delle case è costruita tra il 1954 e il 2000 con alcuni outlier di costruzione antecedente.

```{r}
summary(HousePrices$YearRemodAdd)
boxplot(HousePrices$YearRemodAdd)
hist(HousePrices$YearRemodAdd, freq = F)
plot(density(HousePrices$YearRemodAdd, na.rm = T))
```

La data dell'ultima ristrutturazione è solitamente recente: tra il 1967 e il 2004, ma c'è anche una grande quantità di edifici che non sono stati ristrutturati dopo gli anni 50'.

```{r}
sum(HousePrices$MasVnrArea == 0, na.rm = T)
summary(HousePrices$MasVnrArea[HousePrices$MasVnrArea != 0])
boxplot(HousePrices$MasVnrArea[HousePrices$MasVnrArea != 0])
hist(HousePrices$MasVnrArea[HousePrices$MasVnrArea != 0], freq = F)
plot(density(HousePrices$MasVnrArea[HousePrices$MasVnrArea != 0], na.rm = T))
qqnorm(HousePrices$MasVnrArea[HousePrices$MasVnrArea != 0])
qqline(HousePrices$MasVnrArea[HousePrices$MasVnrArea != 0])
```

Notiamo che 861 case non hanno rivestimenti dei muri e quindi possiamo non analizzarne la superficie. Escludendo queste notiamo che comunque prevalgono superfici con rivestimenti basse tra i 113 e i 330 piedi quadrati.

```{r}
sum(HousePrices$BsmtFinSF1 == 0, na.rm = T)
summary(HousePrices$BsmtFinSF1[HousePrices$BsmtFinSF1 != 0])
boxplot(HousePrices$BsmtFinSF1[HousePrices$BsmtFinSF1 != 0])
hist(HousePrices$BsmtFinSF1[HousePrices$BsmtFinSF1 != 0], freq = F)
plot(density(HousePrices$BsmtFinSF1[HousePrices$BsmtFinSF1 != 0], na.rm = T))
qqnorm(HousePrices$BsmtFinSF1[HousePrices$BsmtFinSF1 != 0])
qqline(HousePrices$BsmtFinSF1[HousePrices$BsmtFinSF1 != 0])
```

Escludiamo come nel caso precedente dall'analisi della superficie dei seminterrati i valori di superficie pari a 0. Notiamo che le superfici dei seminterrati con la categoria di utilizzo definita in BsmtFinType1 sono distribuiti tra 371 e 867 piedi quadrati con un outlier massimo di 5644 piedi quadrati.

```{r}
sum(HousePrices$BsmtFinSF2 == 0, na.rm = T)
summary(HousePrices$BsmtFinSF2[HousePrices$BsmtFinSF2 != 0])
boxplot(HousePrices$BsmtFinSF2[HousePrices$BsmtFinSF2 != 0])
hist(HousePrices$BsmtFinSF2[HousePrices$BsmtFinSF2 != 0], freq = F)
plot(density(HousePrices$BsmtFinSF2[HousePrices$BsmtFinSF2 != 0], na.rm = T))
qqnorm(HousePrices$BsmtFinSF2[HousePrices$BsmtFinSF2 != 0])
qqline(HousePrices$BsmtFinSF2[HousePrices$BsmtFinSF2 != 0])
```

Per il secondo seminterrato notiamo che ci sono ancora più valori nulli e i valori si abbassano notevolmente rispetto alla precedente analisi con primo e terzo quartile 178 e 551.

```{r}
sum(HousePrices$BsmtUnfSF == 0, na.rm = T)
summary(HousePrices$BsmtUnfSF[HousePrices$BsmtUnfSF != 0])
boxplot(HousePrices$BsmtUnfSF[HousePrices$BsmtUnfSF != 0])
hist(HousePrices$BsmtUnfSF[HousePrices$BsmtUnfSF != 0], freq = F)
plot(density(HousePrices$BsmtUnfSF[HousePrices$BsmtUnfSF != 0], na.rm = T))
qqnorm(HousePrices$BsmtUnfSF[HousePrices$BsmtUnfSF != 0])
qqline(HousePrices$BsmtUnfSF[HousePrices$BsmtUnfSF != 0])
```

Sono molto più frequenti i seminterrati non finiti, per le superfici di questi continua a valere l'analisi di BsmtFinSF1.

```{r}
sum(HousePrices$TotalBsmtSF == 0, na.rm = T)
summary(HousePrices$TotalBsmtSF[HousePrices$TotalBsmtSF != 0])
boxplot(HousePrices$TotalBsmtSF[HousePrices$TotalBsmtSF != 0])
hist(HousePrices$TotalBsmtSF[HousePrices$TotalBsmtSF != 0], freq = F)
plot(density(HousePrices$TotalBsmtSF[HousePrices$TotalBsmtSF != 0], na.rm = T))
qqnorm(HousePrices$TotalBsmtSF[HousePrices$TotalBsmtSF != 0])
qqline(HousePrices$TotalBsmtSF[HousePrices$TotalBsmtSF != 0])
```

Le superfici totali dei seminterrati sono tra 810 e 1310 piedi quadrati.

```{r}
summary(HousePrices$X1stFlrSF)
boxplot(HousePrices$X1stFlrSF)
hist(HousePrices$X1stFlrSF, freq = F)
plot(density(HousePrices$X1stFlrSF, na.rm = T))
qqnorm(HousePrices$X1stFlrSF)
qqline(HousePrices$X1stFlrSF)
```

```{r}
sum(HousePrices$X2ndFlrSF == 0, na.rm = T)
summary(HousePrices$X2ndFlrSF[HousePrices$X2ndFlrSF != 0])
boxplot(HousePrices$X2ndFlrSF[HousePrices$X2ndFlrSF != 0])
hist(HousePrices$X2ndFlrSF[HousePrices$X2ndFlrSF != 0], freq = F)
plot(density(HousePrices$X2ndFlrSF[HousePrices$X2ndFlrSF != 0], na.rm = T))
qqnorm(HousePrices$X2ndFlrSF[HousePrices$X2ndFlrSF != 0])
qqline(HousePrices$X2ndFlrSF[HousePrices$X2ndFlrSF != 0])
```

```{r}
sum(HousePrices$LowQualFinSF == 0, na.rm = T)
summary(HousePrices$LowQualFinSF[HousePrices$LowQualFinSF != 0])
boxplot(HousePrices$LowQualFinSF[HousePrices$LowQualFinSF != 0])
hist(HousePrices$LowQualFinSF[HousePrices$LowQualFinSF != 0], freq = F)
plot(density(HousePrices$LowQualFinSF[HousePrices$LowQualFinSF != 0], na.rm = T))
qqnorm(HousePrices$LowQualFinSF[HousePrices$LowQualFinSF != 0])
qqline(HousePrices$LowQualFinSF[HousePrices$LowQualFinSF != 0])
```

La maggior parte delle case non hanno finiture di bassa qualità. In quelle che c'è la superficie varia principalmente tra 168 e 477 piedi quadrati. Notiamo inoltre che la distribuzione è bimodale.

```{r}
summary(HousePrices$GrLivArea)
boxplot(HousePrices$GrLivArea)
hist(HousePrices$GrLivArea, freq = F)
plot(density(HousePrices$GrLivArea, na.rm = T))
qqnorm(HousePrices$GrLivArea)
qqline(HousePrices$GrLivArea)
```

```{r}
summary(HousePrices$TotRmsAbvGrd)
table(HousePrices$TotRmsAbvGrd)
boxplot(HousePrices$TotRmsAbvGrd)
hist(HousePrices$TotRmsAbvGrd)
```
```{r}
summary(HousePrices$GarageYrBlt)
boxplot(HousePrices$GarageYrBlt)
hist(HousePrices$GarageYrBlt, freq = F)
plot(density(HousePrices$GarageYrBlt, na.rm = T))
```

Si evidenzia anche negli anni di costruzione dei garage una distribuzione a più mode. I garage sono soprattutto di costruzione recente con un picco di costruzioni negli anni 2000.

```{r}
sum(HousePrices$GarageArea == 0, na.rm = T)
summary(HousePrices$GarageArea[HousePrices$GarageArea != 0])
boxplot(HousePrices$GarageArea[HousePrices$GarageArea != 0])
hist(HousePrices$GarageArea[HousePrices$GarageArea != 0], freq = F)
plot(density(HousePrices$GarageArea[HousePrices$GarageArea != 0], na.rm = T))
qqnorm(HousePrices$GarageArea[HousePrices$GarageArea != 0])
qqline(HousePrices$GarageArea[HousePrices$GarageArea != 0])
```

La distribuzione dell'area del garage ha più mode, le mode probabilmente corrispondono con la capienza in numero di auto per cui il garage è stato costruito.

```{r}
sum(HousePrices$WoodDeckSF == 0, na.rm = T)
summary(HousePrices$WoodDeckSF[HousePrices$WoodDeckSF != 0])
boxplot(HousePrices$WoodDeckSF[HousePrices$WoodDeckSF != 0])
hist(HousePrices$WoodDeckSF[HousePrices$WoodDeckSF != 0], freq = F)
plot(density(HousePrices$WoodDeckSF[HousePrices$WoodDeckSF != 0], na.rm = T))
qqnorm(HousePrices$WoodDeckSF[HousePrices$WoodDeckSF != 0])
qqline(HousePrices$WoodDeckSF[HousePrices$WoodDeckSF != 0])
```

```{r}
sum(HousePrices$OpenPorchSF == 0, na.rm = T)
summary(HousePrices$OpenPorchSF[HousePrices$OpenPorchSF != 0])
boxplot(HousePrices$OpenPorchSF[HousePrices$OpenPorchSF != 0])
hist(HousePrices$OpenPorchSF[HousePrices$OpenPorchSF != 0], freq = F)
plot(density(HousePrices$OpenPorchSF[HousePrices$OpenPorchSF != 0], na.rm = T))
qqnorm(HousePrices$OpenPorchSF[HousePrices$OpenPorchSF != 0])
qqline(HousePrices$OpenPorchSF[HousePrices$OpenPorchSF != 0])
```

```{r}
sum(HousePrices$EnclosedPorch == 0, na.rm = T)
summary(HousePrices$EnclosedPorch[HousePrices$EnclosedPorch != 0])
boxplot(HousePrices$EnclosedPorch[HousePrices$EnclosedPorch != 0])
hist(HousePrices$EnclosedPorch[HousePrices$EnclosedPorch != 0], freq = F)
plot(density(HousePrices$EnclosedPorch[HousePrices$EnclosedPorch != 0], na.rm = T))
qqnorm(HousePrices$EnclosedPorch[HousePrices$EnclosedPorch != 0])
qqline(HousePrices$EnclosedPorch[HousePrices$EnclosedPorch != 0])
```

```{r}
sum(HousePrices$X3SsnPorch == 0, na.rm = T)
summary(HousePrices$X3SsnPorch[HousePrices$X3SsnPorch != 0])
boxplot(HousePrices$X3SsnPorch[HousePrices$X3SsnPorch != 0])
hist(HousePrices$X3SsnPorch[HousePrices$X3SsnPorch != 0], freq = F)
plot(density(HousePrices$X3SsnPorch[HousePrices$X3SsnPorch != 0], na.rm = T))
qqnorm(HousePrices$X3SsnPorch[HousePrices$X3SsnPorch != 0])
qqline(HousePrices$X3SsnPorch[HousePrices$X3SsnPorch != 0])
```

```{r}
sum(HousePrices$ScreenPorch == 0, na.rm = T)
summary(HousePrices$ScreenPorch[HousePrices$ScreenPorch != 0])
boxplot(HousePrices$ScreenPorch[HousePrices$ScreenPorch != 0])
hist(HousePrices$ScreenPorch[HousePrices$ScreenPorch != 0], freq = F)
plot(density(HousePrices$ScreenPorch[HousePrices$ScreenPorch != 0], na.rm = T))
qqnorm(HousePrices$ScreenPorch[HousePrices$ScreenPorch != 0])
qqline(HousePrices$ScreenPorch[HousePrices$ScreenPorch != 0])
```

```{r}
sum(HousePrices$PoolArea == 0, na.rm = T)
summary(HousePrices$PoolArea[HousePrices$PoolArea != 0])
boxplot(HousePrices$PoolArea[HousePrices$PoolArea != 0])
hist(HousePrices$PoolArea[HousePrices$PoolArea != 0], freq = F)
plot(density(HousePrices$PoolArea[HousePrices$PoolArea != 0], na.rm = T))
qqnorm(HousePrices$PoolArea[HousePrices$PoolArea != 0])
qqline(HousePrices$PoolArea[HousePrices$PoolArea != 0])
```

Ci sono solo 7 piscine, troppo pochi valori.

```{r}
sum(HousePrices$MiscVal == 0, na.rm = T)
summary(HousePrices$MiscVal[HousePrices$MiscVal != 0])
boxplot(HousePrices$MiscVal[HousePrices$MiscVal != 0])
hist(HousePrices$MiscVal[HousePrices$MiscVal != 0], freq = F)
plot(density(HousePrices$MiscVal[HousePrices$MiscVal != 0], na.rm = T))
qqnorm(HousePrices$MiscVal[HousePrices$MiscVal != 0])
qqline(HousePrices$MiscVal[HousePrices$MiscVal != 0])
```

Non analizzo la variabile MiscVal in quanto le dimesioni di diverse caratteristiche della casa non sono comparabili (non posso comparare la grandezza di un campo da tennis con la grandezza di un ascensore)

```{r}
summary(HousePrices$MoSold)
hist(HousePrices$MoSold, freq = F)
```

Vengono vendute più case nei mesi primaverili ed estivi rispetto alle stagioni autunnali e invernali

```{r}
summary(HousePrices$YrSold)
barplot(table(HousePrices$YrSold))
```

Si evidenzia una descrescita nelle vendite nel 2010, forse dovuta al termine delle osservazioni nel dataset

```{r}
summary(HousePrices$SalePrice)
boxplot(HousePrices$SalePrice)
hist(HousePrices$SalePrice, freq = F)
plot(density(HousePrices$SalePrice, na.rm = T))
qqnorm(HousePrices$SalePrice)
qqline(HousePrices$SalePrice)
```

I prezzi di vendità delle case sono nel range tra 34900 e 755000 con una media di circa 181000. La distribuzione è asimmetrica: non ci sono molte case a prezzi bassi, ce ne sono molte invece che superano il terzo quartile.

### Multivariata

```{r}
boxplot(log(HousePrices$SalePrice)~HousePrices$LotShape)
table(HousePrices$LotShape)
```

prezzo <-subset(data,select = c( credit limit,MSSubClass,BsmtFullBath,BsmtHalfBath 
                                fullBath,HalfBath,BedroomAbvGr,KitchenAbvGr,Fireplaces,GarageCars))




prezzo$"creditlimit" <- as.numeric(prezzo$"creditlimit")
                              levels= c(1,2,3)
                              labels= c("abbastanza","non abbastanza")
 prezzo$"MSSubClass" <- factor(prezzo$"creditlimit")
                              levels= c(1,2,3)
                              labels= c("abbastanza","non abbastanza") 
prezzo$"BsmtFullBath" <- as.numeric(prezzo$"BsmtFullBath")
                              levels= c(1,2,3)
                              labels= c("abbastanza","non abbastanza")
prezzo$"BsmtHalfBath" <- as.numeric(prezzo$"BsmtHalfBath")
                              levels= c(1,2,3)
                              labels= c("abbastanza","non abbastanza")
prezzo$"HalfBath" <- as.numeric(prezzo$"HalfBath")
                              levels= c(1,2,3)
                              labels= c("abbastanza","non abbastanza")
prezzo$"BedroomAbvGr" <- as.numeric(prezzo$"BedroomAbvGr")
                              levels= c(1,2,3)
                              labels= c("abbastanza","non abbastanza")
prezzo$"KitchenAbvGr" <- as.numeric(prezzo$"KitchenAbvGr")
                              levels= c(1,2,3)
                              labels= c("abbastanza","non abbastanza")
prezzo$"Fireplaces" <- as.numeric(prezzo$"Fireplaces")
                              levels= c(1,2,3)
                              labels= c("abbastanza","non abbastanza")
prezzo$"GarageCars" <- as.numeric(prezzo$"GarageCars")
                              levels= c(1,2,3)
                              labels= c("abbastanza","non abbastanza")
prezzo$"fullBath" <- as.numeric(prezzo$" fullBath")
                              levels= c(1,2,3)
                              labels= c("abbastanza","non abbastanza")
#Prova de Anova
Variable_limitate <-subset(Data, select =credit limit,MSSubClass,BsmtFullBath,BsmtHalfBath,fullBath,HalfBath,BedroomAbvGr,KitchenAbvGr,Fireplaces,GarageCars
